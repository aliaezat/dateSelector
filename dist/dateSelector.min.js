!function($){const PLUGIN_PREFIX="ds_",DB_DATE_FORMAT="YYYY-MM-DD";var _plugin_count=0,dateSelector=function(element,options,plugin_count){var instance=this;this.settings={date:moment(),mode:"weekly",weekStart:"MON",onDateSelected:null},this.plugin_count=plugin_count,this.prefix="ds_"+plugin_count+"_",this.wrapperId=this.prefix+"wrapper",this.control=null,this.container=$(element),this.dayClassName="ds_day",this.dayNameClassName="ds_dayName",this.dayNumberClassName="ds_dayNumber",this.initialize(options),this.build()};dateSelector.prototype={constructor:dateSelector,initialize:function(options){var instance=this;this.settings=$.extend(!0,{},this.settings,options),this.selectedDate=moment(this.settings.date),this.range=this.getRange()},build:function(){var instance=this;this.construct(),this.createEvents()},construct:function(){var instance=this;this.constructControl(),this.updateDisplay()},constructControl:function(){var instance=this;this.control=$('<div id="'+this.wrapperId+'" class="ds_wrapper"></div>'),this.container.append(this.control),this.title=$('<div class="ds_title"></div>'),this.control.append(this.title),this.navigation=$('<div class="ds_navigation"></div>'),this.control.append(this.navigation),this.leftNavigation=$('<div class="ds_leftNavigation"></div>'),this.leftNavigation.append('<a href="javascript:void(0);"><i class="material-icons">keyboard_arrow_left</i></a>'),this.navigation.append(this.leftNavigation),this.days=$('<div class="ds_days"></div>'),this.navigation.append(this.days),this.rightNavigation=$('<div class="ds_rightNavigation"></div>'),this.rightNavigation.append('<a href="javascript:void(0);"><i class="material-icons">keyboard_arrow_right</i></a>'),this.navigation.append(this.rightNavigation)},updateDisplay:function(){var instance=this;this.displayTitle(),this.displayDays()},displayDays:function(){var instance=this,range=this.range,daysCount,dayWidthPercentage=(100/(range.end.diff(range.start,"days")+1)).toFixed(2),divWidth=this.navigation.width()-this.leftNavigation.width()-this.rightNavigation.width();this.days.width(divWidth),this.days.html("");var appendDaySection=function(date,text,container,className){var div=$("<div></div>");div.addClass(className);var anchor=$('<a href="javascript:void(0);"></a>');anchor.html(text),div.append(anchor),container.append(div)};for(i=moment(range.start);i<=range.end;i.add("days",1)){var selected=!1;i.format("YYYY-MM-DD")===this.selectedDate.format("YYYY-MM-DD")&&(selected=!0);var div=$('<div class="'+this.dayClassName+'"></div>');div.data("date",i.format("YYYY-MM-DD")),div.css("width",dayWidthPercentage+"%"),selected&&div.addClass("selected"),appendDaySection(i,i.format("ddd"),div,this.dayNameClassName),appendDaySection(i,i.format("D"),div,this.dayNumberClassName),this.days.append(div)}},displayTitle:function(){var instance=this,period=this.GetPeriodText();this.title.html(period)},getRange:function(day){var instance=this;day||(day=moment(this.selectedDate));var weekStart=this.settings.weekStart,rangeStart=null,rangeEnd=null;return"month"===this.settings.mode?(rangeStart=moment(day).startOf("month"),rangeEnd=moment(day).endOf("month")):(rangeStart=this.getStartOfWeek(day,weekStart),rangeEnd=moment(rangeStart).add("days",6)),{start:rangeStart,end:rangeEnd}},getStartOfWeek:function(momentDate,weekStart){var weekStartNums={SUN:1,MON:2,TUE:3,WED:4,THU:5,FRI:6,SAT:7},defaultWeekStart="MON";weekStart?(weekStart=weekStart.toUpperCase()).length>3&&(weekStart=weekStart.substring(0,3)):weekStart="MON",weekStartNums[weekStart]||(weekStart="MON");var dateObj=momentDate.toDate(),dayNum=dateObj.getDay()+1,diff=weekStartNums[weekStart]-dayNum;weekStartNums[weekStart]>dayNum&&(diff-=7);var startOfWeekDate=new Date(dateObj.setDate(dateObj.getDate()+diff));return moment(startOfWeekDate)},createEvents:function(){var instance=this;instance.leftNavigation.click((function(){instance.navigateLeft()})),instance.rightNavigation.click((function(){instance.navigateRight()})),instance.control.on("click","."+instance.dayClassName,(function(){var element=$(this);instance.onDateSelected(element)}))},onDateSelected:function(element){var instance=this,allDaysElements=this.control.find("."+this.dayClassName),date,args={date:moment(element.data("date")),trigger:element};allDaysElements.removeClass("selected"),element.addClass("selected"),this.settings.onDateSelected&&this.settings.onDateSelected(args)},navigateLeft:function(){var instance=this,currentRangeStart=this.range.start,dateInNewRange=(currentRangeStart=moment(currentRangeStart)).add("days",-1);this.range=this.getRange(dateInNewRange),this.updateDisplay()},navigateRight:function(){var instance=this,currentRangeEnd=this.range.end,dateInNewRange=(currentRangeEnd=moment(currentRangeEnd)).add("days",1);this.range=this.getRange(dateInNewRange),this.updateDisplay()},GetPeriodText:function(){var instance=this,text="",range=this.range,startDate=range.start,endDate=range.end;return text=startDate.format("YYYY-MM-DD")==endDate.format("YYYY-MM-DD")?startDate.format("D MMM YYYY"):startDate.year()!=endDate.year()?startDate.format("D MMM YYYY")+" - "+endDate.format("D MMM YYYY"):startDate.month()!=endDate.month()?startDate.format("D MMM")+" - "+endDate.format("D MMM YYYY"):startDate.month()===endDate.month()?startDate.format("MMMM YYYY"):startDate.format("D")+" - "+endDate.format("D MMM YYYY")}},$.fn.dateSelector=function(options,args){var instance=this.data("dateSelector");if(void 0===options||"object"==typeof options)return this.each((function(){instance||$.data(this,"dateSelector",new dateSelector(this,options,_plugin_count++))}));if("string"==typeof options){if("get"===options)return instance.selectedDate;"set"===options&&(instance.selectedDate=args,instance.updateDisplay())}return this}}(jQuery);